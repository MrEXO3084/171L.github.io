<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>171L传媒 | 创意内容平台</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 所有之前的CSS样式保持不变 */
        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #0f3460;
            --highlight: #e94560;
            --gold: #ffd700;
            --blue: #3498db;
            --text: #f5f5f5;
            --text-secondary: #b0b0b0;
            --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --success: #2ecc71;
            --error: #e74c3c;
            --warning: #f39c12;
            --radius: 10px;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* 404页面样式 */
        .error-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
            text-align: center;
        }

        .error-content {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border-radius: var(--radius);
            padding: 3rem;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .error-icon {
            font-size: 5rem;
            margin-bottom: 1.5rem;
            color: var(--highlight);
        }

        .error-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, var(--highlight), var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .error-message {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .error-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* 其他样式保持不变 */
        .page {
            display: none;
            width: 100%;
            min-height: 100vh;
            opacity: 0;
            transition: opacity 0.5s ease;
            position: relative;
        }

        .page.active {
            display: block;
            opacity: 1;
        }

        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
            position: relative;
        }

        .login-container, .register-container {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border-radius: var(--radius);
            padding: 3rem;
            width: 90%;
            max-width: 450px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.15);
            animation: fadeIn 0.5s ease;
            position: relative;
            z-index: 1;
        }

        /* 其余CSS样式与之前相同 */
        /* ... 所有其他样式保持不变 ... */
    </style>
</head>
<body>
    <!-- 404错误页面 -->
    <div id="error-page" class="page">
        <div class="error-container">
            <div class="error-content">
                <div class="error-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h1 class="error-title">页面未找到</h1>
                <p class="error-message">
                    抱歉，您访问的页面不存在。<br>
                    正在为您重定向到首页...
                </p>
                <div class="error-actions">
                    <button class="btn btn-primary" id="goHome">
                        <i class="fas fa-home"></i> 立即返回首页
                    </button>
                    <button class="btn btn-secondary" id="goBack">
                        <i class="fas fa-arrow-left"></i> 返回上一页
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 原有的所有页面内容 -->
    <!-- 登录页面 -->
    <div id="login-page" class="page">
        <!-- 原有登录页面内容 -->
    </div>

    <!-- 注册页面 -->
    <div id="register-page" class="page">
        <!-- 原有注册页面内容 -->
    </div>

    <!-- 主网站内容 -->
    <div id="main-website" class="page">
        <!-- 原有主网站内容 -->
    </div>

    <!-- 其他模态框等保持不变 -->

    <script>
        // 路由处理 - 解决GitHub Pages 404问题
        class Router {
            constructor() {
                this.routes = {
                    '/': 'login-page',
                    '/login': 'login-page',
                    '/register': 'register-page',
                    '/home': 'main-website'
                };
                
                this.init();
            }
            
            init() {
                // 监听URL变化
                window.addEventListener('popstate', () => {
                    this.handleRoute();
                });
                
                // 初始路由处理
                this.handleRoute();
                
                // 拦截所有链接点击，使用pushState
                document.addEventListener('click', (e) => {
                    if (e.target.matches('a[href^="/"]') || 
                        e.target.matches('a[href^="#"]') && !e.target.matches('a[href^="#"]')) {
                        e.preventDefault();
                        const href = e.target.getAttribute('href');
                        this.navigate(href);
                    }
                });
            }
            
            handleRoute() {
                const path = window.location.pathname;
                const hash = window.location.hash.substring(1);
                
                // 处理主要路由
                if (this.routes[path]) {
                    this.showPage(this.routes[path]);
                } 
                // 处理哈希路由（锚点）
                else if (hash && document.getElementById(hash)) {
                    this.showPage('main-website');
                    // 滚动到对应元素
                    setTimeout(() => {
                        const element = document.getElementById(hash);
                        if (element) {
                            window.scrollTo({
                                top: element.offsetTop - 80,
                                behavior: 'smooth'
                            });
                        }
                    }, 100);
                }
                // 默认路由
                else {
                    this.showPage('login-page');
                }
            }
            
            navigate(path) {
                if (path.startsWith('#')) {
                    // 处理锚点链接
                    window.location.hash = path;
                    this.handleRoute();
                } else {
                    // 使用pushState更新URL
                    window.history.pushState({}, '', path);
                    this.handleRoute();
                }
            }
            
            showPage(pageId) {
                // 隐藏所有页面
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });
                
                // 显示目标页面
                const targetPage = document.getElementById(pageId);
                if (targetPage) {
                    targetPage.classList.add('active');
                } else {
                    // 如果页面不存在，显示404页面
                    document.getElementById('error-page').classList.add('active');
                }
            }
        }

        // 应用初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化路由
            const router = new Router();
            
            // 404页面按钮事件
            document.getElementById('goHome').addEventListener('click', () => {
                router.navigate('/');
            });
            
            document.getElementById('goBack').addEventListener('click', () => {
                window.history.back();
            });
            
            // 原有的应用实例化
            const app = new App();
            app.init();
            
            // 修改原有的页面切换逻辑，使用路由系统
            const originalShowPage = app.showPage;
            app.showPage = function(e, pageId) {
                if (e) e.preventDefault();
                
                let path = '/';
                switch(pageId) {
                    case 'login-page': path = '/login'; break;
                    case 'register-page': path = '/register'; break;
                    case 'main-website': path = '/home'; break;
                }
                
                router.navigate(path);
            };
        });

        // 原有的App类保持不变
        class App {
            constructor() {
                this.currentUser = null;
                this.users = JSON.parse(localStorage.getItem('users')) || [];
                this.messages = JSON.parse(localStorage.getItem('messages')) || [];
                this.isGuestMode = false;
                this.announcement = localStorage.getItem('announcement') || "欢迎来到171L传媒官方互动站！我们会持续更新优质内容，敬请关注！\n\n【最新更新】留言举报功能优化\n- 优化了举报类型选择框的样式，使其更加直观易用\n- 调整了举报提示信息，统一显示\"举报成功\"\n- 保护管理员和创始人留言不被删除\n- 提升了整体用户体验\n\n感谢大家的支持与反馈！";
                this.faqData = JSON.parse(localStorage.getItem('faqData')) || [
                    {
                        question: "如何注册账号？",
                        answer: "点击网站右上角的'注册'按钮，填写用户名、昵称和密码即可完成注册。"
                    },
                    {
                        question: "忘记密码怎么办？",
                        answer: "目前网站暂不支持密码找回功能，请确保妥善保管您的密码。如有需要，可以联系客服寻求帮助。"
                    },
                    {
                        question: "如何修改个人资料？",
                        answer: "登录后点击右上角的用户头像，进入个人资料页面即可修改昵称、密码和头像。"
                    },
                    {
                        question: "为什么无法发布留言？",
                        answer: "请确保您已登录账号。游客模式下无法发布留言，需要登录后才能使用留言功能。"
                    },
                    {
                        question: "如何举报不当留言？",
                        answer: "在每个留言卡片的底部有举报按钮，点击后选择举报类型并填写举报原因即可。我们会及时处理您的举报。"
                    }
                ];
                this.reportingMessageId = null;
            }

            init() {
                this.bindEvents();
                this.cleanupData();
                this.checkLoginStatus();
                this.initializeMessages();
                this.renderFaq();
                
                if (this.messages.length === 0) {
                    this.addSampleMessages();
                }
            }

            // 其他方法保持不变
            // ...
        }
    </script>
</body>
</html>
